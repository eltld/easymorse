<div class='pinchComponent'>
	<div id='p3Image' class='pinchImage'></div>
</div>
<script>
	$('#p3Image').css('background', 'url("images/p3a.jpg")');

	$('#p3Image').on('touchstart touchmove touchend', function(e) {
		e.preventDefault();
		var touch = e.originalEvent.touches[0];
		var obj = $('#p3Image')[0];

		if (e.type == 'touchstart') {
			obj.lastX = touch.pageX;
			obj.lastY = touch.pageY;
			
			if (!obj.moveX) {
				obj.moveX = 0;
				obj.moveY = 0;
			}
			
			obj.propagation = e.originalEvent.targetTouches.length == 1;
			console.log('touch start');
		}

		if (e.type == 'touchmove') {
			if(obj.propagation){
				obj.singleTouchMoved=true;	
			}else if(!obj.singleTouchMoved){
				e.stopPropagation();
				
				obj.moveX += (touch.pageX - obj.lastX);
				obj.moveY += (touch.pageY - obj.lastY);
				
				$('#p3Image').css(
						'-webkit-transform',
						'translate3d(' + obj.moveX/0.4 + 'px,' + obj.moveY/0.4
								+ 'px,0)');

				console.log('==>>moveX:' + obj.moveX);

				obj.lastX = touch.pageX;
				obj.lastY = touch.pageY;
			}
		}

		if (e.type == 'touchend' && e.originalEvent.targetTouches.length==0) {
			obj.singleTouchMoved=false;
			console.log('touch end');
		}

	});
	
	$('#p3Image').on('gesturestart gesturechange gestureend',function(e){
		var obj=$('#p3Image')[0];
		
		if(e.type=='gesturechange'){
			obj.scale=e.originalEvent.scale*0.4;
			obj.rotation=e.originalEvent.rotation;
			console.log('gesture change');
		}
	}
</script>