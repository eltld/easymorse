<div class='pinchComponent'>
	<div id='p3Image' class='pinchImage'></div>
</div>
<script>
$('#p3Image').css('background','url("images/p3a.jpg")');

$('#p3Image').on('touchstart touchmove touchend',function(e) {
	e.preventDefault();
	var obj=$('#p3Image')[0];
	var touch=e.originalEvent.touches[0];
	
	if(e.type=='touchstart'){
		obj.propagation=e.originalEvent.touches.length==1;
		obj.lastX=touch.pageX;
		obj.lastY=touch.pageY;
	}
	
	if(e.type=='touchmove' && !obj.propagation){
// 		var touch=e.originalEvent.touches[0];
// 		$('#p3Image').parent().css('-webkit-transform','translate('+touch.pageX+'px,'+touch.pageY+'px)');
		
		$('#p3Image').parent().css('-webkit-transform','scale('+obj.scale+') '+
 				'rotate('+obj.rotation+'deg)'+
 				'translate('+touch.clientX+'px,'+touch.clientY+'px)');
// 		$('#p3Image').parent().css('-webkit-animation-duration','0');
		
// 		+
// 			'translate('+touch.pageX+'px,'+touch.pageY+'px)'
		
		console.log('touch move, X,Y:'+touch.clientX+','+touch.clientY);
		
		obj.lastX=touch.pageX;
		obj.lastY=touch.pageY;
	}
	
	if(e.originalEvent.touches.length>1 || !obj.propagation){
		e.stopPropagation();
		
		if(e.type=='touchend'){
			obj.propagation=false;
		}
	}else{
		console.log('do single touch:'+e.type);
	}
});

$('#p3Image').on('gesturestart gesturechange gestureend',function(e){
	e.preventDefault();
	e.stopPropagation();
	
	var obj=$('#p3Image')[0];
	
	if(e.type=='gesturestart'){
		console.log('===>>gesture start ');
	}
	
	if(e.type=='gesturechange'){
// 		$('#p3Image').parent().css('-webkit-transform','scale('+e.originalEvent.scale*0.4+') '+
// 				'rotate('+e.originalEvent.rotation+'deg)');
		obj.scale=e.originalEvent.scale*0.4;
		obj.rotation=e.originalEvent.rotation;
		console.log('gesture change');
	}
	
	if(e.type=='gestureend'){
		console.log('gesture end');
	}
});
</script>